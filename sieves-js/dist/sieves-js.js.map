{"version":3,"file":"sieves-js.js","sources":["../src/controllers/filterable/form_controller.js","../src/controllers/filterable/sort_controller.js","../src/controllers/index.js","../src/index.js"],"sourcesContent":["import { Controller } from \"@hotwired/stimulus\"\n\nexport default class extends Controller {\n  static values = {\n    filtersPath: String\n  }\n\n  static targets = ['submitBtn', 'conjonction']\n\n  updateColumn({ params }) {\n    this.submitBtnTarget.innerHTML = \"loader\"\n    this.#getValueInput(params.index).disabled = true\n\n    this.#refreshForm()\n  }\n\n  updateOperator({ target, params }) {\n    const operatorNeedsInput = !['empty', 'not_empty'].includes(target.value)\n\n    const valueInput = this.#getValueInput(params.index)\n    if (operatorNeedsInput) {\n      valueInput.style.removeProperty('display')\n      valueInput.disabled = false\n    } else {\n      valueInput.disabled = true\n      valueInput.style.display = 'none'\n    }\n  }\n\n  updateConjonction({ target: { options, selectedIndex }}) {\n    const conjonctionText = options[selectedIndex].text\n    this.conjonctionTargets.forEach((conjonctionTarget) => {\n      conjonctionTarget.innerText = conjonctionText\n    })\n  }\n\n  #getValueInput(index) {\n    return this.element.querySelector(`[data-value-input-index=\"${index}\"]`)\n  }\n\n  #refreshForm() {\n    const url = new URL(window.origin + this.filtersPathValue)\n    const formData = new FormData(this.element)\n    for (const [key, value] of formData.entries()) { url.searchParams.append(key, value) }\n    for (const field of this.element.elements) { field.disabled = true }\n\n    fetch(url)\n      .then(response => response.text())\n      .then(html => Turbo.renderStreamMessage(html))\n  }\n}\n","import { Controller } from \"@hotwired/stimulus\"\n\nexport default class extends Controller {\n  #SORT_INPUT_ID = \"filterable_sort\"\n\n  static values = {\n    formId: String,\n    columnName: String,\n  }\n\n  sortColumn() {\n    const previousSort = this.#filterableFormElement.querySelector(`#${this.#SORT_INPUT_ID}`)\n    let order = 'asc'\n    if (previousSort && previousSort.dataset.columnName === this.columnNameValue) {\n      order = previousSort.value === 'asc' ? 'desc' : 'asc'\n    }\n    previousSort?.remove()\n\n    this.#filterableFormElement.insertAdjacentHTML(\"afterbegin\", `\n    <input type=\"hidden\"\n           value=\"${order}\"\n           data-column-name=\"${this.columnNameValue}\"\n           autocomplete=\"off\"\n           name=\"filterable[sort][${this.columnNameValue}]\"\n           id=\"${this.#SORT_INPUT_ID}\">\n    `)\n    this.#filterableFormElement.submit()\n  }\n\n  get #filterableFormElement() {\n    return document.getElementById(this.formIdValue)\n  }\n}\n","import filterableFormController from \"./filterable/form_controller\"\nimport filterableSortController from \"./filterable/sort_controller\"\n\n\nexport default {\n  \"filterable--form\": filterableFormController,\n  \"filterable--sort\": filterableSortController\n}\n","import controllers from \"./controllers\"\n\nconst controllersRegistration = (application) => {\n  Object.values(controllers).forEach(controller => {\n    application.register(controller.name, controller)\n  })\n}\n\nexport { controllersRegistration }\n"],"names":["updateColumn","Controller","_ref","params","this","submitBtnTarget","innerHTML","_classPrivateFieldLooseBase","_getValueInput","index","disabled","updateOperator","_ref2","operatorNeedsInput","includes","target","value","valueInput","style","removeProperty","display","updateConjonction","_ref3","_ref3$target","conjonctionText","options","selectedIndex","text","conjonctionTargets","forEach","conjonctionTarget","innerText","element","querySelector","_refreshForm2","_step","url","URL","window","origin","filtersPathValue","formData","FormData","entries","_iterator","done","key","searchParams","append","_step2","_iterator2","_createForOfIteratorHelperLoose","elements","field","fetch","then","response","html","Turbo","renderStreamMessage","values","filtersPath","String","targets","sortColumn","previousSort","_SORT_INPUT_ID","order","dataset","columnName","columnNameValue","remove","insertAdjacentHTML","submit","document","getElementById","formIdValue","formId","controllers","filterableFormController","filterableSortController","application","Object","controller","register","name"],"mappings":"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"}