{"version":3,"file":"sieves-js.modern.js","sources":["../src/controllers/filterable/form_controller.js","../src/controllers/filterable/sort_controller.js","../src/controllers/index.js","../src/index.js"],"sourcesContent":["import { Controller } from \"@hotwired/stimulus\"\n\nexport default class extends Controller {\n  static values = {\n    filtersPath: String\n  }\n\n  static targets = ['submitBtn', 'conjonction']\n\n  updateColumn({ params }) {\n    this.submitBtnTarget.innerHTML = \"loader\"\n    this.#getValueInput(params.index).disabled = true\n\n    this.#refreshForm()\n  }\n\n  updateOperator({ target, params }) {\n    const operatorNeedsInput = !['empty', 'not_empty'].includes(target.value)\n\n    const valueInput = this.#getValueInput(params.index)\n    if (operatorNeedsInput) {\n      valueInput.style.removeProperty('display')\n      valueInput.disabled = false\n    } else {\n      valueInput.disabled = true\n      valueInput.style.display = 'none'\n    }\n  }\n\n  updateConjonction({ target: { options, selectedIndex }}) {\n    const conjonctionText = options[selectedIndex].text\n    this.conjonctionTargets.forEach((conjonctionTarget) => {\n      conjonctionTarget.innerText = conjonctionText\n    })\n  }\n\n  #getValueInput(index) {\n    return this.element.querySelector(`[data-value-input-index=\"${index}\"]`)\n  }\n\n  #refreshForm() {\n    const url = new URL(window.origin + this.filtersPathValue)\n    const formData = new FormData(this.element)\n    for (const [key, value] of formData.entries()) { url.searchParams.append(key, value) }\n    for (const field of this.element.elements) { field.disabled = true }\n\n    fetch(url)\n      .then(response => response.text())\n      .then(html => Turbo.renderStreamMessage(html))\n  }\n}\n","import { Controller } from \"@hotwired/stimulus\"\n\nexport default class extends Controller {\n  #SORT_INPUT_ID = \"filterable_sort\"\n\n  static values = {\n    formId: String,\n    columnName: String,\n  }\n\n  sortColumn() {\n    const previousSort = this.#filterableFormElement.querySelector(`#${this.#SORT_INPUT_ID}`)\n    let order = 'asc'\n    if (previousSort && previousSort.dataset.columnName === this.columnNameValue) {\n      order = previousSort.value === 'asc' ? 'desc' : 'asc'\n    }\n    previousSort?.remove()\n\n    this.#filterableFormElement.insertAdjacentHTML(\"afterbegin\", `\n    <input type=\"hidden\"\n           value=\"${order}\"\n           data-column-name=\"${this.columnNameValue}\"\n           autocomplete=\"off\"\n           name=\"filterable[sort][${this.columnNameValue}]\"\n           id=\"${this.#SORT_INPUT_ID}\">\n    `)\n    this.#filterableFormElement.submit()\n  }\n\n  get #filterableFormElement() {\n    return document.getElementById(this.formIdValue)\n  }\n}\n","import filterableFormController from \"./filterable/form_controller\"\nimport filterableSortController from \"./filterable/sort_controller\"\n\n\nexport default {\n  \"filterable--form\": filterableFormController,\n  \"filterable--sort\": filterableSortController\n}\n","import controllers from \"./controllers\"\n\nconst controllersRegistration = (application) => {\n  Object.values(controllers).forEach(controller => {\n    application.register(controller.name, controller)\n  })\n}\n\nexport { controllersRegistration }\n"],"names":["_getValueInput","_classPrivateFieldLooseKey","_refreshForm","Controller","updateColumn","params","this","submitBtnTarget","innerHTML","_classPrivateFieldLooseBase","index","disabled","updateOperator","target","operatorNeedsInput","includes","value","valueInput","style","removeProperty","display","updateConjonction","options","selectedIndex","conjonctionText","text","conjonctionTargets","forEach","conjonctionTarget","innerText","element","querySelector","url","URL","window","origin","filtersPathValue","formData","FormData","key","entries","searchParams","append","field","elements","fetch","then","response","html","Turbo","renderStreamMessage","values","filtersPath","String","targets","_class","constructor","args","super","Object","defineProperty","_filterableFormElement","get","_get_filterableFormElement","set","_SORT_INPUT_ID","writable","sortColumn","previousSort","order","dataset","columnName","columnNameValue","remove","insertAdjacentHTML","submit","document","getElementById","formIdValue","formId","controllers","filterableFormController","filterableSortController","controllersRegistration","application","controller","register","name"],"mappings":"oPAEAA,eAAAC,EAAA,iBAAAC,eAAAD,EAAA,eAA6BE,MAAAA,UAAAA,EAO3BC,eAAAA,GAAAA,SAAAA,GAAAA,OAAAA,eAAAA,KAAAA,EAAAA,CAAAA,MAAAA,IAAAA,OAAAA,eAAAA,KAAAA,EAAAA,CAAAA,MAAAA,GAAAA,CAAAA,cAAaC,OAAEA,IACbC,KAAKC,gBAAgBC,UAAY,SACjCC,EAAAH,KAAAN,GAAAA,GAAoBK,EAAOK,OAAOC,UAAW,EAE7CF,EAAAH,KAAAJ,GAAAA,IACD,CAEDU,gBAAeC,OAAEA,EAAFR,OAAUA,IACvB,MAAMS,GAAsB,CAAC,QAAS,aAAaC,SAASF,EAAOG,OAEnDC,EAAAR,EAAGH,KAAoBD,GAAAA,GAAAA,EAAOK,OAC1CI,GACFG,EAAWC,MAAMC,eAAe,WAChCF,EAAWN,UAAW,IAEtBM,EAAWN,UAAW,EACtBM,EAAWC,MAAME,QAAU,OAE9B,CAEDC,mBAAoBR,QAAQS,QAAEA,EAAFC,cAAWA,KACrC,MAAqBC,EAAGF,EAAQC,GAAeE,KAC/CnB,KAAKoB,mBAAmBC,QAASC,IAC/BA,EAAkBC,UAAYL,GAEjC,aAEcd,GACb,OAAOJ,KAAKwB,QAAQC,cAAe,4BAA2BrB,MAC/D,cAGC,MAASsB,EAAG,IAAAC,IAAQC,OAAOC,OAAS7B,KAAK8B,kBACnCC,EAAW,IAAAC,SAAahC,KAAKwB,SACnC,IAAK,MAAOS,EAAKvB,KAAUqB,EAASG,UAAaR,EAAIS,aAAaC,OAAOH,EAAKvB,GAC9E,IAAK,MAAM2B,KAASrC,KAAKwB,QAAQc,SAAYD,EAAMhC,UAAW,EAE9DkC,MAAMb,GACHc,KAAKC,GAAYA,EAAStB,QAC1BqB,KAAKE,GAAQC,MAAMC,oBAAoBF,GAC3C,GA9CMG,OAAS,CACdC,YAAaC,QAGRC,EAAAA,QAAU,CAAC,YAAa,+FCLlB,MAAAC,UAAyBpD,EAAAqD,eAAAC,GAAAC,SAAAD,GAAAE,OAAAC,eAAAtD,KAAAuD,EAAA,CAAAC,IAAAC,EAAAC,SAAA,IAAAL,OAAAC,eAAAtD,KAAA2D,EAAA,CAAAC,UAAA,EAAAlD,MACrB,mBADqB,CAQtCmD,aACE,MAAMC,EAAe3D,EAAAH,KAAAuD,GAAAA,GAA4B9B,cAAe,IAADtB,EAAIH,KAAoB2D,GAAAA,MACvF,IAAII,EAAQ,MACRD,GAAgBA,EAAaE,QAAQC,aAAejE,KAAKkE,kBAC3DH,EAA+B,QAAvBD,EAAapD,MAAkB,OAAS,aAElDoD,GAAAA,EAAcK,SAEdhE,EAAAH,KAAAuD,GAAAA,GAA4Ba,mBAAmB,aAAe,iDAE9CL,oCACW/D,KAAKkE,sFAEAlE,KAAKkE,qCALwB/D,EAMhDH,KAAoB2D,GAAAA,cAEjCxD,EAAAH,KAAAuD,GAAAA,GAA4Bc,QAC7B,WAE4BZ,IAC3B,OAAOa,SAASC,eAAevE,KAAKwE,YACrC,GA1BM3B,OAAS,CACd4B,OAAQ1B,OACRkB,WAAYlB,QCHhB,IAAe2B,EAAA,CACb,mBAAoBC,EACpB,mBAAoBC,GCJhBC,QAA2BC,IAC/BzB,OAAOR,OAAO6B,GAAarD,QAAQ0D,IACjCD,EAAYE,SAASD,EAAWE,KAAMF,EACvC,EACF"}